- name: Install httpd
  become: True
  package:
    state: present
    name: "{{ 'apache2' if ansible_pkg_mgr == 'apt' else 'httpd' }}"

- name: Create link to /etc/mime.types
  become: True
  file:
    state: link
    src: /etc/mime.types
    dest: "{{ httpd_conf }}/mime.types"

- name: Register httpd version
  command: bash -c "httpd -v | head -n1 | awk '{print substr($3,8,3)}'"
  register: httpd_version_var

- debug: var=httpd_version_var
  tags: [never, debug]

# Unlike source or miniconda, we don't know the version that has been installed
- set_fact:
    httpd_version: "{{ httpd_version_var.stdout }}"
    httpd_major_version: "{{ httpd_version_var.stdout }}"
