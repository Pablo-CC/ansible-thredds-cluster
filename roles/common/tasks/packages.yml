- name: Check if {{ item.name }} package exist
  local_action: find 
  args:
    path: "{{ local_download }}" 
    patterns: "{{ item.archive_file_name }}"
  register: packages_file

- name: Download {{ item.name }} package
  run_once: true
  local_action: get_url 
  args:
    url: "{{ item.archive_file_url }}" 
    dest: "{{ local_download }}"
    headers: "{{ item.header }}"
  when:
    - packages_file.matched == 0

- name: Unarchive {{ item.name }} package
  unarchive:
    src: "{{ local_download }}/{{ item.archive_file_name }}"
    dest: "{{ source_service }}"
  when:
    - binary_file.matched == 0

- include: install_packages.yml
  when:
    - item.compile == true