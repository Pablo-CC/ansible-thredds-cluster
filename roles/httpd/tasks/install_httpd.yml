# Create httpd directories in remote host
- name: Create directories
  file:
    dest: "{{ item }}"
    state: directory
  with_items:
   - "{{ httpd_install_base }}"
   - "{{ httpd_opt }}"

# Check if binary file exists in local machine for each distribution
- name: Check if httpd binary exists
  local_action: find 
  args:
    path: "{{ local_download }}" 
    patterns: "{{ httpd_binary }}"
  register: binary_file

- name: Include source.yml if binary doesn't exist
  include: source.yml
  when: 
   - (binary_file is defined and binary_file.matched == 0)

- name: Unarchive httpd binary
  unarchive:
    src: "{{ local_download }}/{{ httpd_binary }}"
    dest: "{{ httpd_opt }}"
  when: 
    - (binary_file is defined and binary_file.matched == 1)
