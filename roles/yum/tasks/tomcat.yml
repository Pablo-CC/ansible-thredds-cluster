- name: Install tomcat
  become: True
  package:
    state: present
    name: tomcat{{ tomcat_version if ansible_pkg_mgr == "apt" else "" }}
  tags: install

- name: Register tomcat version
  command: bash -c "tomcat version | head -n1 | awk '{split($4,v,\"/\"); print v[2]}'"
  register: tomcat_version_var

- set_fact:
    tomcat_version: "{{ tomcat_version_var.stdout }}"
    tomcat_major_version: "{{ tomcat_version_var.stdout[:1] }}"
    tomcat_home: /usr/share/{{ ['tomcat',tomcat_major_version]|join if ansible_pkg_mgr == 'apt' else 'tomcat' }}
