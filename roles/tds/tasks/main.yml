- name: Download tds
  run_once: True
  local_action: get_url
  args:
    url: "{{ tds_download_url }}"
    dest: "{{ downloads}}/{{ tds_filename }}"
  vars:
    ansible_become: False

- name: Create webapps/thredds
  file: state=directory path={{ tomcat_base }}/{{ item.name }}/webapps/thredds
  with_items: "{{ tomcats }}"

- name: Unarchive TDS
  unarchive: src={{ downloads }}/{{ tds_filename }} dest={{ tomcat_base }}/{{ item.name }}/webapps/thredds
  with_items: "{{ tomcats }}"

- name: Create content/thredds
  file: path="{{ tomcat_base}}/{{ item.name }}/content/thredds" state=directory
  with_items: "{{ tomcats }}"
