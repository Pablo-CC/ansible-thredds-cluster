---
# tasks file for haproxy_pablo
#
- name: Set variables for backend servers
  set_fact:
    haproxy_from_source: False
    haproxy_conf_file: "{{ haproxy_conf_file }}"
    default_backend: "{{ default_backend }}"
    default_frontend: "{{ default_frontend }}"
    ansible_become: "{{ ansible_become | default(True) }}"

- name: Install HAProxy
  yum:
    name: haproxy
    state: present

- name: Create stats socket directory
  file: 
    path: /run/haproxy
    state: directory

- name: Copy error files
  copy:
    src: errors
    dest: /etc/haproxy

- name: Copy HAProxy's configuration file
  template: 
    src: haproxy.cfg.j2
    dest: "{{ haproxy_conf_file }}"

