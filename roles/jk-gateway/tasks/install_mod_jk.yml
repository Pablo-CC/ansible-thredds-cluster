- name: Download mod_jk
  run_once: True
  local_action: get_url
  args:
    url: "{{ mod_jk_download_url }}"
    dest: "{{ mod_jk_downloads_tmp }}"
  vars:
    ansible_become: False

- name: Create mod_jk_src directory
  file: path="{{ mod_jk_src }}" state=directory
  
- name: Unarchive mod_jk
  unarchive:
    src: "{{ mod_jk_downloads_tmp }}/{{ mod_jk_filename }}"
    dest: "{{ mod_jk_src }}"

- name: Configure and install mod_jk
  become: "{{ ansible_become | default(False) }}"
  command: "{{ item }}"
  args:
    chdir: "{{ mod_jk_src }}/{{ mod_jk_filename_unarchive }}/native"
  with_items:
    - ./configure {{ mod_jk_configure | default("") }}
    - /usr/bin/make
    - /usr/bin/make install
