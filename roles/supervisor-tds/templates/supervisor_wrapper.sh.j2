#!/bin/bash

CATALINA_HOME={{ tomcat_home }}
CATALINA_BASE={{ tomcat_base }}/{{ item.name }}

{% if item.tds_debug is defined %}
JPDA_ADDRESS={{ item.tds_debug.jpda_address | default('localhost:8000') }}
. {{ tomcat_home }}/bin/catalina.sh jpda start
{% else %}
. {{ tomcat_home }}/bin/catalina.sh start
{% endif %}


# Allow any signal which would kill a process to stop Tomcat
trap shutdown HUP INT QUIT ABRT KILL ALRM TERM TSTP

echo "Waiting for `cat $CATALINA_PID`"
wait `cat $CATALINA_PID`
