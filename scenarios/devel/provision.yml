- name: Provision all hosts
  hosts: all
  become: True
  vars:
    common:
      - python-passlib
      - net-tools
      - unzip
      - vim
      - telnet
    apt:
      - build-essential
    yum:
      - "@Development tools"
  tasks:
    - yum:
        name: epel-release
      when: ansible_pkg_mgr == "yum"
      
    - package:
        name: "{{ item }}"
        state: present
      with_items: "{{ common }}"

    - yum:
        name: "{{ item }}"
        state: present
      with_items: "{{ yum }}"
      when: ansible_pkg_mgr == "yum"

    - apt:
        name: "{{ item }}"
        state: present
      with_items: "{{ apt }}"
      when: ansible_pkg_mgr == "apt"
