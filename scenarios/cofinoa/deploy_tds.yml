- name: Deploy tds
  hosts: hostD
  vars:
    tds_instances:
      - name: "{{ inventory_hostname }}_1800"
        base_port: 1800
        ip_address: "{{ hostvars[ inventory_hostname ]['ansible_ssh_host'] }}"
        ajp: 
          port: 18009
          proxyName: localhost
          proxyPort: 8000

      - name: "{{ inventory_hostname }}_2800"
        base_port: 2800
        ip_address: "{{ hostvars[ inventory_hostname ]['ansible_ssh_host'] }}"
        ajp: 
          port: 28009 
          proxyName: localhost
          proxyPort: 8000
  roles:
    - {role: common}
    - {role: tds, tags: tds}