---
- hosts: all
  sudo: true
  vars:
    http_port: 8001
  tasks:

    - name: install Apache2.4
      yum: 
        name: httpd
        update_cache: yes

    - name: apache2 listen on port {{ http_port }}
      lineinfile: dest=/etc/httpd/conf/httpd.conf regexp="^Listen" line="Listen "{{ http_port }}"" state=present
      notify:
        - restart apache2

  handlers:
    - name: restart apache2
      service: name=httpd state=restarted